<!DOCTYPE html>
<html lang="en" xml:lang="en">
<head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Multiple Domains with Free Wildcard Cloudflare SSL [Tutorial] </title>
    <link rel="dns-prefetch" href="//maxcdn.bootstrapcdn.com">
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Domain names you own could be your most expensive to do list. What’s more a domain without a valid SSL will show up in all modern browsers as an insecure content. In this blog post, I will explain how to minimize the cost of owning multiple wildcard SSL-protected domains using Cloudflare and set them up with Github Pages, Heroku or NGINX.">
    <meta name="robots" content="all">
    <meta name="author" content="Paweł Urbanek">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/styles.css?201802222159" type="text/css">

    
      <meta name="keywords" content="heroku, cloudflare, github pages, free ssl, save money, startup, landing page, lets encrypt">
    

    <link rel="canonical" href="https://pawelurbanek.com/2018/01/22/setup-multiple-domains-with-free-ssl-from-cloudflare/">
    <link rel="alternate" type="application/rss+xml" title="RSS Feed for Paweł Urbanek - Web and Mobile Developer, Full Stack Blog" href="/feed.xml" />


    <!-- Verifications -->
    

    <!-- Open Graph -->
    <!-- From: https://github.com/mmistakes/hpstr-jekyll-theme/blob/master/_includes/head.html -->
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Multiple Domains with Free Wildcard Cloudflare SSL [Tutorial] ">
    <meta property="og:description" content="Domain names you own could be your most expensive to do list. What’s more a domain without a valid SSL will show up in all modern browsers as an insecure content. In this blog post, I will explain how to minimize the cost of owning multiple wildcard SSL-protected domains using Cloudflare and set them up with Github Pages, Heroku or NGINX.">
    <meta property="og:url" content="https://pawelurbanek.com/2018/01/22/setup-multiple-domains-with-free-ssl-from-cloudflare/">
    <meta property="og:site_name" content="Paweł Urbanek - Web and Mobile Developer, Full Stack Blog">
    
    <meta property="og:image" content="https://pawelurbanek.com/assets/signs-bfb1f5fc4b30c1d171fa529dd9a39097eeaf23a1e1ade991de7f9089abba4cb4.jpg">
    


    <!-- Twitter Card -->
    
      <meta name="twitter:card" content="summary_large_image">
      <meta property="og:image:width" content="800">
      <meta property="og:image:height" content="500">
      <meta property="article:published_time" content="2018-01-22T10:00:00+01:00" />
    

    
    <meta name="twitter:image" content="https://pawelurbanek.com/assets/signs-bfb1f5fc4b30c1d171fa529dd9a39097eeaf23a1e1ade991de7f9089abba4cb4.jpg">
    

    <meta name="twitter:site" content="@_pawurb" />
    <meta name="twitter:creator" content="@_pawurb" />

    <meta name="twitter:title" content="Multiple Domains with Free Wildcard SSL from Cloudflare" />
    <meta name="twitter:description" content="Domain names you own could be your most expensive to do list. What’s more a domain without a valid SSL will show up in all modern browsers as an insecure content. In this blog post, I will explain how to minimize the cost of owning multiple wildcard SSL-protected domains using Cloudflare and set them up with Github Pages, Heroku or NGINX." />
    <meta name="twitter:url" content="https://pawelurbanek.com/2018/01/22/setup-multiple-domains-with-free-ssl-from-cloudflare/" />

    <!-- Icons -->
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-160x160.png" sizes="160x160">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">


    
    <script type="text/javascript">
       (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
       (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
       })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
       ga('create', 'UA-34244867-12', 'auto');
       ga('send', 'pageview');
    </script>
    

    
<!-- Google Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": {
      "@type":"WebPage",
      "@id":"https://pawelurbanek.com/2018/01/22/setup-multiple-domains-with-free-ssl-from-cloudflare/"
    },
    "headline": "Multiple Domains with Free Wildcard SSL from Cloudflare",
    "image": {
      "@type": "ImageObject",
      "url": "https://pawelurbanek.com/assets/signs-bfb1f5fc4b30c1d171fa529dd9a39097eeaf23a1e1ade991de7f9089abba4cb4.jpg",
      "height": 500,
      "width": 800
    },
    "datePublished": "2018-01-22",
    "dateModified": "2018-02-01",
    "author": {
      "@type": "Person",
      "name": "Paweł Urbanek"
    },
    "publisher": {
      "@type": "Organization",
      "name": "PabloWeb Paweł Urbanek",
      "logo": {
        "@type": "ImageObject",
        "url": "https://pawelurbanek.com/assets/pabloweb-69223ab6871fe2232fabdd00e23d420a15170da8a9644aee5f73a422067629c4.jpg",
        "width": 600,
        "height": 60
      }
    },
    "description": "Domain names you own could be your most expensive to do list. What’s more a domain without a valid SSL will show up in all modern browsers as an insecure content. In this blog post, I will explain how to minimize the cost of owning multiple wildcard SSL-protected domains using Cloudflare and set them up with Github Pages, Heroku or NGINX.",
    "keywords": "heroku, cloudflare, github pages, free ssl, save money, startup, landing page, lets encrypt"
  }
  </script>


</head>

<body class="site">
  

  <div class="site-wrap">
    <header class="site-header px2 px-responsive">
  <div class="mt2 wrap">
    <div class="measure">
      <div class='site-title'>
        <h1 class='author-name'>
          <a class='main-title' href="https://pawelurbanek.com">Paweł Urbanek</a>
        </h1>
        <br>
        <h2 class='blog-title'>
          <a href="https://pawelurbanek.com" class='subtitle'>Full Stack Blog</a>
        </h2>
      </div>
      <nav class="site-nav">
        




    

    
        <a class='theme-color' href="/">Home</a>
    




    

    
        <a class='theme-color' href="/about">About</a>
    




    

    
        <a class='theme-color' href="/contact">Contact</a>
    




        
          <div class="social-icons">
  <div class="social-icons-right">
    
      <a class="fa fa-github" href="https://github.com/pawurb" target="_blank"></a>
    
    
      <a class="fa fa-twitter" href="https://twitter.com/_pawurb" target="_blank"></a>
    
  </div>
  <div class="right">
    
  </div>
</div>
<div class="clearfix"></div>

        
      </nav>
      <div class="clearfix"></div>
    </div>
  </div>
</header>


    <div class="post p2 p-responsive wrap" role="main">
      <div class="measure">
        



  
    <link rel="amphtml" href="https://pawelurbanek.com/amp/2018/01/22/setup-multiple-domains-with-free-ssl-from-cloudflare">
  


<div class="post-header mb2">
  <h1>Multiple Domains with Free Wildcard SSL from Cloudflare</h1>
  <span class="post-meta theme-color">Jan 22, 2018</span><br>
  
  <span class="post-meta small">
  
    4 minute read
  
  </span>
</div>

<article class="post-content">
  <p><img class="center-image post-main-image" alt="Multiple http domains can be cheap" src="/assets/signs-bfb1f5fc4b30c1d171fa529dd9a39097eeaf23a1e1ade991de7f9089abba4cb4.jpg" /></p>

<p>Domain names you own could be your most expensive to do list. What’s more a domain without a valid SSL will show up in all modern browsers as an insecure content. In this blog post, I will explain how to minimize the cost of owning multiple wildcard SSL-protected domains using Cloudflare and set them up with Github Pages, Heroku or NGINX.</p>

<p>After I did not renew yet another domain for one of my <em>not-so-profitable-yet</em> side projects I decided to change a strategy. Now I am hosting most of my projects on subdomains of one root domain: <a href="https://apki.io" target="_blank">apki.io</a>. I’ve used it for a couple of projects so far:</p>

<p><a href="https://abot.apki.io" target="_blank">https://abot.apki.io</a></p>

<p><a href="https://wishlist.apki.io" target="_blank">https://wishlist.apki.io</a></p>

<p><a href="https://selfcontrol.apki.io" target="_blank">https://selfcontrol.apki.io</a></p>

<p><a href="https://focus.apki.io/" target="_blank">https://focus.apki.io</a></p>

<p><a href="https://tracky.apki.io/" target="_blank">https://tracky.apki.io</a></p>

<p>My only cost is the yearly renewal of the root domain. Each of these sites has a grade A SSL which works in all the browsers. Here’s how you can do it:</p>

<h2 id="buy-a-root-domain">Buy a “root” domain</h2>

<p>I usually use <a href="https://www.gandi.net/" target="_blank">Gandi</a> but it does not really matter which provider you choose. There are plenty of tutorials explaining how to buy a domain so I will not elaborate on that.</p>

<h2 id="setup-cloudflare-and-free-ssl-certificate">Setup Cloudflare and free SSL certificate</h2>

<p><a href="https://www.cloudflare.com/" target="_blank">Cloudflare</a> is a great service providing tons of features ranging from DDOS protection to smart caching and more. We will focus on how to use it to configure free SSL.</p>

<p>First, you need to move your domain’s nameservers to Cloudflare. After adding a domain to your Cloudflare panel you will be able to check if new config has already propagated. Keep in mind that it can take up to 24 hours.</p>

<p>Next, you need to issue a Cloudflare SSL certificate for your domain. They provide a free wildcard certificate. You can do it in a <code class="highlighter-rouge">Crypto</code> tab bar:</p>

<p><img class="center-image" alt="Cloudflare free wildcard SSL was issued" src="/assets/cloudflare_ssl-40256cd99a4efcb0ffe9677df08a69fb159cc2e2507c5029dbd3a703ebb77277.png" /></p>

<p><span class="annotation">In case that after 24 hours they are still “Authorizing Certificate” you should contact support.</span></p>

<h2 id="setup-github-pages">Setup Github Pages</h2>

<p><a href="https://pages.github.com/" target="_blank">Github Pages</a> is a popular solution for hosting static pages. This blog itself is placed there and powered by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a>. It is free as long as you are using a public GitHub repo. Out of the box, it provides an <code class="highlighter-rouge">https://[Your username].github.io</code> domain for you, however with a minimal configuration you can setup your own domain for free.</p>

<p>First, you need to change your DNS config to point to GitHub’s IP (<code class="highlighter-rouge">192.30.252.154</code>) using an A record. You can do it in Cloudflare DNS settings:</p>

<p><img class="center-image" alt="DNS A config in Cloudflare panel" src="/assets/dns_a_config-25e0e85cda78fc35a3e0b2fd081b6c92f922c9c4773b0d8de18dd41d38de18b0.png" /></p>

<p>then in your project settings on GitHub, you should add a custom domain name:</p>

<p><img class="center-image" alt="GitHub settings, setup custom domain with no cost SSL" src="/assets/github_settings-a5d06af41dcea16bb5d38de48180ff7d164f3ade32aad1582dfcc74beccaee89.png" /></p>

<p>That’s it, your website should be up running.</p>

<h2 id="setup-heroku">Setup Heroku</h2>

<p>If you need something more complex than a static page then <a href="https://heroku.com/" target="_blank">Heroku</a> could be a thing for you. By default, it offers an <code class="highlighter-rouge">https://[Your app name].herokuapp.com</code> domain. Same as with GitHub pages you can hook your own domain with SSL without any additional costs.</p>

<p>Start with adding your domain name in Heroku’s app settings:</p>

<p><img class="center-image" alt="Heroku settings, setup custom domain with free SSL" src="/assets/heroku_domain-8bc1696ee1bb65057ba42134a0aeb1d6db380438c4b535a586f9de3b9b55fb6e.png" />
<span class="annotation">Don’t worry about those error messages, it works anyway</span></p>

<p>Then add a CNAME record pointing your subdomain to default Heroku URL in your Cloudflare DNS dashboard:</p>

<p><img class="center-image" alt="Cloudflare CNAME DNS setting" src="/assets/dns_cname-b7b3a6920efccabd626557a3d4fa897c1c696bb4dbb773950fbc1e542156a2f8.png" />
<span class="annotation">Add a CNAME record pointing subdomain to https://[Your app name].herokuapp.com</span></p>

<p>Your Heroku app should now be available on your custom domain with full SSL support.</p>

<h2 id="setup-nginx">Setup NGINX</h2>

<p>If you are using a custom hosting infrastructure then <a href="https://nginx.org/en/" target="_blank">NGINX</a> could be your front-end server. In this case you can still hook free SSL with a custom domain.</p>

<p>Start with pointing your domain to your server’s IP using an A DNS record. Next, check out two detailed articles on Cloudflare support explaining how to complete the setup:</p>

<p><a href="https://support.cloudflare.com/hc/en-us/articles/115000479507" target="_blank">Creating and managing certificates with Origin CA</a></p>

<p><a href="https://support.cloudflare.com/hc/en-us/articles/217471977" target="_blank">How to install an Origin CA certificate in NGINX</a></p>

<h2 id="final-remarks">Final remarks</h2>

<p>Keep in mind that when working with DNS and SSL configuration you probably will run into some caching related issues. I usually use <a href="https://www.whatsmydns.net/" target="_blank">DNS Propagation Checker</a> to see if changes have already been applied. Still, some of the settings could be cached locally on your computer. On macOS running these commands could help:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">sudo </span>killall <span class="nt">-HUP</span> mDNSResponder
<span class="nb">sudo </span>killall mDNSResponderHelper
<span class="nb">sudo </span>dscacheutil <span class="nt">-flushcache</span></code></pre></figure>

<p>If not then you could check if it works on different browsers or your mobile device. Rule of the thumb, if it should work but it still doesn’t I just leave it for a couple of hours and then check again ¯\<em>(ツ)</em>/¯.</p>

<p>There’s also <a href="https://letsencrypt.org/" target="_blank">Let’s Encrypt</a> you can use to setup free SSL. So far Cloudflare has always been good enough for what I needed.</p>

<p>Obviously, you can use all of those tips for top-level domains as well. Hope it helps you shave a few bucks off what you spend on your online projects.</p>

<p><strong>Disclaimer:</strong> I’m not a web security expert. I would not recommend using these tips for a project with bank-level security requirements. Let me know in the comments if you notice some security loopholes in those settings.</p>


</article>


  <div class="share-page">
  <div class="share-links">
    
      <a class="fa fa-twitter" href="https://twitter.com/intent/tweet?text=Multiple+Domains+with+Free+Wildcard+SSL+from+Cloudflare&amp;url=https%3A%2F%2Fpawelurbanek.com%2F2018%2F01%2F22%2Fsetup-multiple-domains-with-free-ssl-from-cloudflare%2F" rel="nofollow" target="_blank" title="Share on Twitter"></a>
    
    
      <a class="fa fa-facebook" href="https://facebook.com/sharer.php?u=https%3A%2F%2Fpawelurbanek.com%2F2018%2F01%2F22%2Fsetup-multiple-domains-with-free-ssl-from-cloudflare%2F" rel="nofollow" target="_blank" title="Share on Facebook"></a>
    
  </div>
</div>




  <div class="page-navigation">
  
    <a class="prev navigation-link" href="/2018/01/15/limit-rails-memory-usage-fix-R14-and-save-money-on-heroku/">&laquo; Reduce Rails Memory Usage, Fix R14 and Save Money on Heroku</a>

  
  
    <a class="right next navigation-link" href="/2018/01/29/setup-ssl-proxy-for-insecure-browser-content-with-ruby-and-nginx/"> Simple SSL Proxy for Insecure Browser Content with Ruby or NGINX &raquo;</a>
  
</div>

<div class="post-footer">
  <p>
    Posted by Paweł Urbanek on Jan 22, 2018
    <br>
    Find me on <a class='link' target='_blank' href="https://twitter.com/_pawurb">Twitter</a> or <a class='link' target='_blank' href="https://github.com/pawurb">GitHub</a>.
  </p>
</div>

<div class='center'>
  <p>Subscribe if you want to be notified about new blog posts. I promise no spam.</p>
    <div id="mc_embed_signup">
  <form action="https://pawelurbanek.us17.list-manage.com/subscribe/post?u=185903fd35e2bd56525298439&amp;id=d8064f77fc" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
      <div id="mc_embed_signup_scroll">

  <div class="mc-field-group">
    <input type="email" value="" name="EMAIL" class="required email input-form" placeholder='Email' id="mce-EMAIL">
  </div>
    <div id="mce-responses" class="clear">
      <div class="response" id="mce-error-response" style="display:none"></div>
      <div class="response" id="mce-success-response" style="display:none"></div>
    </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
      <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_185903fd35e2bd56525298439_d8064f77fc" tabindex="-1" value=""></div>
      <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
      </div>
  </form>
  </div>

</div>




  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname  = 'pawelurbanek';
    var disqus_identifier = '/2018/01/22/setup-multiple-domains-with-free-ssl-from-cloudflare';
    var disqus_title      = "Multiple Domains with Free Wildcard SSL from Cloudflare";

    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>




      </div>
    </div>
  </div>

  <footer class="center">
  <div class="measure">
    <small>
      © Paweł Urbanek 2018
    </small>
  </div>
</footer>


  
<!-- Fonts -->

<link href='//fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic' rel='stylesheet' type='text/css'>
<link href='//fonts.googleapis.com/css?family=Lato:900,300' rel='stylesheet' type='text/css'>



  <link href="//maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">


</body>
</html>
